# Compute API
The Compute API defines the replacements for SAS application servers that have been used throughout SAS
Version 9.  The Compute API provides clients the ability to perform the following tasks:

* Submit and execute SAS code.
* Obtain the SAS log or listing information from executed SAS code.
* View the output that is generated from a SAS code submission.
* Access SAS data sets that are created by a SAS code submission.
* Access SAS filerefs that are created by a SAS code submission.
* Access SAS variables that are defined and used in a SAS code submission.
* Retrieve information about engines that are available in a session.

There are endpoints that are described by this API that enable you to perform Create, Read, Update, and Delete operations for
defining a Compute context. A Compute context is analogous to the SAS Application Server from the SAS V9 engine. There are also endpoints that
enable you to request a Compute session. A Compute session runs on a SAS Compute Server and serves as
the access point to SAS language processing in this environment. A Compute session replaces the functionality of the SAS Workspace Server and
SAS Stored Process Server from SAS 9.

The Compute API supports the ability for you to perform the following tasks:

* Define a Compute context.
* Manage a Compute context.
* Create a Compute session to work in.
* Reference resources from other APIs.
* Submit a job to run in a Compute session. A job can be a single line of SAS code or a complex SAS program.
* Obtain the log of all submitted SAS code during a Compute session.
* Obtain the listing output of all submitted SAS code during a Compute session.
* Obtain links to results for output that is generated by a job that you submitted during a Compute session.
* Access SAS data sets that are available to you.
* Access files via SAS filerefs that are available to you.
* Access SAS macro variables that are defined during a Compute session.
* Retrieve information about available engines in the system.
* Access or update SAS options that are available during a Compute session.

The Compute API also acts as a provider for the following APIs. The Compute API registers itself as a provider
with the name Compute when it interacts with these APIs.

* Job Execution API
* Data Sources API
* Data Tables API
* Row Sets API


#### Life Cycle Management

There are several resources that are available to the Compute API. These resources have different life
cycles, depending on their usage by clients. This section describes the life cycles of these resources.

##### SAS Compute Server

A SAS Compute Server is a running process. The Compute API forwards requests to the SAS Compute Server for processing.
When a client requests a Compute session from the Compute API, the Compute API determines whether there are any
SAS Compute Servers that can handle the request. The client provides a Compute context when requesting a Compute session,
and the Compute API attempts to find a suitable SAS Compute Server to handle the request for that context. If no
 suitable SAS Compute Server is found, a new SAS Compute Server process is launched, and a Compute session is created for the
 new SAS Compute Server.

##### Compute Session

A Compute session is created on the SAS Compute Server when a client needs to perform tasks. The
client makes a request for a session via the Compute API. The Compute session is the starting point for most actions
that take place inside of the SAS Compute Server. Currently, a Compute session lifetime is controlled by the client. When a
client has completed work with a Compute session, it then uses the appropriate Delete command to destroy the Compute session.

You can configure Compute sessions to timeout after a time of inactivity. You can set the timeout period in the Compute context or in the
Compute session request that you use to create the Compute session. After the specified period of inactivity passes, the session
is destroyed.

**Note:** Compute sessions are strongly tied to the SAS Compute Server that they are running on. A Compute session cannot be migrated to
another SAS Compute Server, and the Compute session state is not maintained if the associated SAS Compute Server fails.

##### Jobs
Jobs are units of SAS code that are executed by the client in the Compute session. A job has a state that describes
where it is in its life cycle. A completed job might continue to be accessed for information such as listings, logs or
results. Output from a job might be available to the data and file endpoints of the Compute session.

After a job is destroyed via the appropriate DELETE request, the log, listing, and result resources that are associated with
that job are no longer available via the jobs path for a session. However, the log, listing, and result resources
are available to the session, and you can reach them via the session/<sessionId> endpoints.

If a session that contained a job is destroyed, then all jobs and all resources that are associated with those jobs are
destroyed as well.

##### Logs, Listings, and Results
The log, listing, and result resources are generated by the execution of a job. However, their lifetime is governed
by the Compute session that the job was executed in. A session can have multiple jobs executed in it. Each of these jobs might
create its own logs, listings, and results. You can access the resources for a particular job by going
directly to the desired endpoint under sessions/<sessionId>/jobs/<jobId>. However, you can also access all logs,
listings, and results for the entire session by going to the corresponding endpoint under sessions/<sessionId>.

When a job is destroyed, the content of the log, listing, and result resources that are associated with that job
are still available via the session. When a session is destroyed, all logs, listings, and results are destroyed, as are all
jobs for that session.

##### Data Access
The Compute session allows access to any data sets that are available. These data sets might be generated from a variety of
sources:

* an underlying SAS configuration, such as sasv9.cfg (for example, SASHELP)
* libraries that are configured when a session or job is requested
* a job that executes in a session

Clients might also use the data endpoints to create libraries and upload data sets that are used by SAS code that is
executed in the same Compute session.

Regardless, generated data sets are associated with a Compute session and are available as long as the Compute session is
available. When a session is destroyed, the generated data sets are no longer available via that session. If the data sets
are part of a persisted data storage area, you can continue to access them. If the generated data sets are stored in a
transient area that is owned by the destroyed Compute session (for example, SASWORK), then the data sets are destroyed
also.

##### File Access
A Compute session enables you to access files that are available to the Compute session via SAS
filerefs. These filerefs are generally created by the SAS code that executes in a job. Clients
might create filerefs via the /filerefs endpoint, and these filerefs can be used in SAS code that executes in
the same Compute session.

These filerefs are associated with a Compute session and are available for the duration of the Compute Session.
When a session is destroyed, associated filerefs are no longer available via that session. If the underlying files are part
of a persisted data storage area, then those files continue to exist. If the files are kept in a transient area owned by a
destroyed Compute session, then those files are also destroyed.

#### Attributes
The following attributes can be set in the request media types that are used in the Compute API.

##### sessionInactiveTimeout
* Valid: [`Context Request`](#application-vnd.sas.compute.context.request), [`Session Request`](#application-vnd.sas.compute.session.request)
* Type: Integer
* Units: seconds

Sets the inactivity timeout for a session.  If specified in a Compute context request, the attribute is in effect for any
session that is created from that context.  If specified in a session request, the attribute applies to that session only.

* If the value is positive, a session is terminated if it is inactive for longer than the specified time period.
* If the value is negative or unset, the default value of **15 minutes** is used.
* If the value is **0**, the session does not terminate due to inactivity.

##### resetLogLineNumbers
* Valid: [`Job Request`](#application-vnd.sas.compute.job.request)
* Type: Boolean
* Availability: Added in version 2 of the resource.

If this attribute is set for a job request, then the log line numbers are reset to **0** immediately before the job begins
execution.

## API Request Examples Grouped by Process Type

<details>
<summary>Getting Started</summary>

* [Create a Context](#CreateContext)
* [Get a List of Contexts](#GetContextList)
* [Create a Session](#CreateSession)
* [Add Session Options](#AddSessionOptions)
* [Add Resources](#AddResources)
* [Resource Scope](#ResourceScope)
</details>

<details>
<summary>Running Code</summary>

* [Create a Job](#CreateJob)
* [Determine the State of a Job](#JobState)
* [Get the Log from a Session](#GetSessionLog)
* [Get the Log from a Job](#GetJobLog)
* [Reset Log Line Numbers](#ResetLogLineNumbers)
* [Get Results from a Job](#GetJobResults)
* [Get Session Variables](#GetSessionVariables)
* [Access Session Options](#AccessSessionOptions)
* [Get Available Engines](#GetAvailableEngines)
</details>

<details>
<summary>Accessing Data</summary>

* [List Assigned Librefs](#ListAssignedLibrefs)
* [Assign a New Libref](#AssignNewLibref)
* [List Tables in a Libref](#ListTablesLibref)
* [Get Column Information](#GetColumnInformation)
* [Get Row Information](#GetRowInformation)
* [Access Data via a Row Set Object](#AccessDataRowSetObject)
* [Create a View of Data](#CreateDataView)
* [Update a Table](#UpdateTable)
* [Update a Table Column](#UpdateTableColumn)
* [Delete a Table](#DeleteTable)
</details>

<details>
<summary>Accessing Files</summary>

* [List Assigned Filerefs](#ListAssignedFileref)
* [Assign a New Fileref](#AssignNewFileref)
* [Download a File from a Fileref](#DownloadFileFileref)
* [Upload a File to a Fileref](#UploadFileFileref)
* [Append a File to a Fileref](#AppendFileFileref)
* [Handle a Directory Fileref](#HandleDirectoryFileref)
* [Handle a Concatenation Fileref](#HandleConcatenationFileref)
</details>

<details>
<summary>Cleanup</summary>

* [End a session](#EndSession)
</details>

#### Getting Started
The following scenarios enable you to get started using the Compute API.

##### <a name='CreateContext'>Create a Context</a>
To create a context, issue the following request.

```
  POST /compute/contexts
```
An application/vnd.sas.compute.context.request body is required to be submitted with this request. Here is a simple example:

```json
  {
     "name": "MyContext",
     "version": 1,
     "description": "My Application Context",
     "launchContext": {
        "contextName": "launcher_context"
      },
     "launchType": "service",
     "authorizeAllAuthenticatedUsers" : true
  }
```

It is highly recommended that applications that need to use the Compute API use the Compute Service Bootstrapping
project to handle the creation of their contexts for them. See Compute-Bootstrap for more details.

**Note:** Only administrators are allowed to create contexts.

##### <a name='GetContextList'>Get a List of Contexts</a>
To get a list of currently defined contexts, issue the following request.

```
  GET /compute/contexts
```
An application/vnd.sas.collection is returned from this request. Standard paging, filtering, and sorting options are
 allowed in a request. Here are some examples.

```
  GET /compute/contexts?start=2&limit=5
  GET /compute/contexts?filter=(startsWith(name,SASStudio)
```
**Note:** The previous filter is for example purposes only. There is no implication that name or SASStudio are valid
parameters for a filter on your request.

##### <a name='CreateSession'>Create a Session</a>
To create a session, make a request to the sessions endpoint of the Compute API. Send an
application/vnd.sas.compute.session.request body with the following request to set other parameters on the session as
needed.

```
   POST /compute/contexts/{contextId}/sessions
```
In this example, contextId refers to a Compute context that is known to the Compute API. The response to this request
includes information and links to the Compute session that was created by application/vnd.sas.compute.session.

**Notes:**
* Only users who are allowed to use the context can create a session. This is governed by the authentication rules
that are defined when the context is created.
* The Compute server process runs under the identity of the user that is requesting the session.

##### <a name='AddSessionOptions'>Add Session Options</a>
A session can be created with customized startup options that use the options array in the environment object of
application/vnd.sas.compute.session.request.

The options apply directly to the SAS session that is started.

An example would be:
```json
   {
     "version": 1,
     "name": "MySession",
     "description": "This is my session for doing some simple work.",
     "attributes": {
     ...
     },
     "environment": {
       "options": [
        "memsize=4g",
        "fullstimer"
       ]
     },
     ...
   }
```

Here is the order in which options are processed:

* !SASROOT/sasv9.cfg
* !SASROOT/sasv9_samples.cfg
* !SASROOT/nls/<lang>/sasv9.cfg
* !SASROOT/sasv9_local.cfg
* $USER/sasv9.cfg
* Context environment options
* Session environment options

Session environment options have the highest priority.

##### <a name='AddResources'>Add Resources</a>

To refer to resources from other services in your Compute session or Compute job,
add resources to your respective session or job request. A resource is a reference to a resource in a service.
To use these, give the resource a name and tell the request the URI and type of the resource. Here is a simple example.

```json
   {
   "name" : "file1",
   "uri" : "/files/files/fedcba98-7654-3210-fedc-ba9876543210"
   "type" : "application/vnd.sas.file"
    }
```
This resource directs the Compute server to assign the object that is located at
/files/files/fedcba98-7654-3210-fedc-ba9876543210 to file1. The type value application/vnd.sas.file indicates to the Compute server
that this is a fileref. Therefore, when this resource is applied, you can reference the resource
/files/files/fedcba98-7654-3210-fedc-ba9876543210 by using the fileref file1.

###### Resource Scope</a>
You can add resources to any job or session request. For resources that are added to a session request, the resource has
SESSION scope. This means that the resource is available throughout the entire session. For resources that are added to a job request,
the user determines the scope. The scope member of the resource enables you to specify whether the scope is JOB
or SESSION. A resource with JOB scope is cleared when the job completes. A resource with SESSION scope remains after the
job completes.

###### Known types</a>
Here are the currently supported types that you can use as a resource.

* **application/vnd.sas.file** - For resources of this type, the Compute server expects the URI to point
to a Files API resource, and the Compute server creates a fileref for that resource. The name that you provide becomes
the fileref. Any options that are specified become options for the assigned fileref, similar to how you define a fileref
in a FILENAME statement. For filerefs that have JOB scope, the fileref is deassigned when the associated job completes.
Resources that are marked for output use are shown in the results.
* **application/vnd.sas.preference** - For resource of this type, the Compute server expects the URI to
point to a Preferences API resource. A macro variable with the same name as the Preferences resource is created, and the
macro variable is assigned to the value of the Preferences resource. You can then access this macro variable in your code.
For resources that are assigned JOB scope, the macro variable is deleted when the associated job completes.
Variables are never shown in results, so the output member has no effect here.

#### Running Code
The following scenarios describe how to run SAS code in the Compute API and how to obtain information about the code that
was executed.

##### <a name='CreateJob'>Create a Job</a>
To execute SAS code, submit an application/vnd.sas.compute.job.request request to the jobs endpoint. The
request body contains information about the job that you are running. This information includes the code to execute and any
SAS options or environment variables that are needed for the job. A link is provided in the response when a session is
created or queried.

```
   POST /compute/sessions/{sessionId}/jobs
```
The SAS code is executed asynchronously. The request above returns immediately with an
application/vnd.sas.compute.job response. This response includes information about the job and links that enable you to
find other information about the job.

##### <a name='JobState'>Determine the State of a Job</a>
Because the SAS code that is submitted in a job is executed asynchronously, you might need to determine the state
of a job as it executes. The job has a state endpoint that you can query to determine its current state. The currently
defined states are starting, running, or completed. A link is provided when a job is created.

```
   GET /compute/sessions/{sessionId}/jobs/{jobId}/state
```
This request returns a text response that indicates the current state of a job. A job with the state
completed has finished executing the SAS code that was submitted. A job with the state warning
has finished executing the SAS code, but there is a warning. A job with the state error has finished executing the SAS
code, but there was an error during code execution.

##### <a name='GetSessionLog'>Get the Log from a Session</a>

A Compute session keeps track of the SAS log that is associated with the code that has been executed in a session. You
might need to query the log to display to a user or to check for errors or warnings that were generated during SAS code
processing. To obtain the Compute session log, make a request to the following endpoint.

```
   GET /compute/sessions/{sessionId}/log
```
You can add query parameters to a request. The most useful is the timeout parameter that enables long polling
for an endpoint. The timeout value tells the Compute server the longest amount of time (in seconds) to wait
for information to return. If no timeout value is specified, a default value of 60 seconds is used.

```
   GET /compute/sessions/{sessionId}/log?timeout=30
```
The response to this request is a collection of application/vnd.sas.compute.logline entries that describe the lines of the
log.

##### <a name='GetJobLog'>Get the Log from a Job</a>

The Compute service has the ability to return log information for a single submitted job. The log
from a job is a subset of the log from the Compute session. The request itself is similar.

```
   GET /compute/sessions/{sessionId}/jobs/{jobId}/log
```
You can add query parameters to a request. The most useful is the timeout parameter, that enables long polling
for an endpoint. The timeout value tells the Compute server the longest amount of time (in seconds) to wait
for information to return. If no timeout is specified, a default value of 60 seconds is used.

```
   GET /compute/sessions/{sessionId}/jobs/{jobId}/log?timeout=30
```
The response to this request is a collection of application/vnd.sas.compute.logline entries that describe the lines of the
log.

##### <a name='ResetLogLineNumbers'>Reset Log Line Numbers</a>

SAS code generates line numbers in the log as it processes. If you use the same session for multiple jobs, it
might be useful to reset the log line numbers before each job runs. You can do this in a job request. Using the same POST
request that you use to create a job, provide an attribute named *resetLogLineNumbers* that forces the session to reset
the log line number before executing the next job.

```
   POST /compute/sessions/{sessionId}/jobs

   {
      "code" : [
         "data x;",
         "a=1;",
         "run;"
         ],
      "attributes" : {
         "resetLogLineNumbers" : true
         }
   }
```

##### <a name='GetJobResults'>Get Results from a Job</a>

Many jobs create some type of result. For these jobs, a results endpoint is available that gets the
output that is generated by a job. To get the results information, submit the following request.

```
  GET /compute/sessions/{sessionId}/jobs/{jobId}/results
```
The response is a collection of application/vnd.sas.compute.result items that include information about the results.
There is a link in each item that takes you to a location where you can download the content.

##### <a name='GetSessionVariables'>Get Session Variables</a>

SAS code that executes in a session can use or create macro variables. You can access these variables before or
after a job has executed. To get variable information from a session, submit the following request.

```
  GET /compute/sessions/{sessionId}/variables
```
The response is a collection of application/vnd.sas.compute.session.variable items that return the value of the
variables. This endpoint supports filtering using the EQ, OR, or AND filtering functions.

```
  GET /compute/sessions/{sessionId}/variables?filter=or(eq(name,AFDSID),eq(name,SYS_COMPUTE_SESSION_ID))
```

##### <a name='AccessSessionOptions'>Access Session Options</a>
You can access SAS options via the options endpoint on the session. To get the value of a specific SAS option that is
used in the session, such as VALIDVARNAME, submit the following submit the following request.

```
  GET /compute/sessions/{sessionId}/options/VALIDVARNAME
```
The response can either be returned as a string or as an application/vnd.sas.compute.session.option resource.  The default
behavior is to return the option as a string using plain text. However, if you require more information about an option,
set the Accept header to application/vnd.sas.compute.session.option+json.

You can update options using the same endpoint. Use a PUT request, and provide a text body to update a value.
```
  PUT /compute/sessions/{sessionId}/options/VALIDVARNAME
  Content-Type: text/plain
  ...
  ANY
```
Some options cannot be updated after initialization. If you request to update an option that falls in this
category, a 400 error is returned.

##### <a name='GetAvailableEnginesf'>Get Available Engines</a>

To support the Data Sources API, we allow you to request the list of available SAS libref engines for
a Compute context. To get the list of available engines from the Compute service, submit the following
request.

```
  GET /compute/sessions/{sessionId}/engines
```
The response is a collection of application/vnd.sas.data.engine items that return information about each engine.

#### Accessing Data
The following scenarios describe how to access SAS data sets via librefs. These librefs might be previously
assigned, created by executing SAS code, or assigned directly via the API.

##### <a name='ListAssignedLibrefs'>List Assigned Librefs</a>
If you need to obtain the list of librefs that are currently defined in your session, query the data
endpoint. No request body is required on this GET request. A collection of application/vnd.sas.compute.library.summary
items is returned that gives you access to the librefs that are currently defined.

```
   GET /compute/sessions/{sessionId}/data
```
You can provide query parameters to this method for pagination to limit the number of items that is returned. The default
limit is 10. Follow the self links in the responses to access the actual application/vnd.sas.compute.library items.

##### <a name='AssignNewLibref'>Assign a New Libref</a>

To assign a new libref, submit an application/vnd.sas.compute.library.request to the data endpoint. This request contains
information about the libref that you want to assign.

```
  POST /compute/sessions/{sessionId}/data
```
Information about the newly assigned libref is returned to you in an application/vnd.sas.compute.library item.

##### <a name='ListTablesLibref'>List Tables in a Libref</a>
To get a listing of all tables in a libref, send a request to the libref for a collection. You must use the Accept header
to get the list of tables. Otherwise, you receive libref properties from application/vnd.sas.compute.library. The collection
that is returned contains application/vnd.sas.compute.data.table.summary items.

```
  GET /compute/sessions/{sessionId}/data/{libref}
  Accept: application/vnd.sas.collection+json
```
Links to the individual tables are provided. Follow the links to access the tables.

##### <a name='GetColumnInformation'>Get Column Information</a>
To obtain column information about a table, send a column request to the table. This request returns
a collection of application/vnd.sas.compute.data.table.column entries that describe each column. A link to this call
is provided in the application/vnd.sas.compute.library object, under columns.

```
  GET /compute/sessions/{sessionId}/data/{libref}/{tableName}/columns
```
Information, such as the label, length, and type of a column, is returned in these entries.

##### <a name='GetRowInformation'>Get Row Information</a>
To get information about rows, submit a request to the rows endpoint of the table. You get a collection of
application/vnd.sas.compute.data.table.row entries that describe each row. A link to this call is provided in the
application/vnd.sas.compute.library object, under rows.

```
  GET /compute/sessions/{sessionId}/data/{libref}/{tableName}/rows
```
The actual data in the data set or table is returned here. By default, the data is formatted. If you want the raw,
unformatted data from the table, add the formatted query parameter and assign a value of false.

For the request above, several options can be passed as query parameters. You can convert the request can into
a POST request and pass the query parameters as part of the request body. You might do this when
the values of the query parameters are exceptionally long, they contain special characters, or they contain sensitive
information.

**Note:** The WHERE clause that is used here is a standard SAS WHERE clause.

```
  POST /compute/sessions/{sessionId}/data/{libref}/{tableName}/rows

  {
     "where" : "x=1"
  }
```

##### <a name='AccessDataRowSetObject'>Access Data via a Row Set Object</a>

You can access data by using a row set object. Row sets contain column and information together, and they allow
more filtering features than simply obtaining the rows. An application/vnd.sas.compute.data.table.row.set object is
returned.

```
  GET /compute/sessions/{sessionId}/data/{libref}/{tableName}/rowSet
```

For the request above, several options can be passed as query parameters. You can convert the request into
a POST request and pass the query parameters as part of the request body. You might do this when the
values of the query parameters are exceptionally long, they contain special characters, or they contain sensitive
information.

**Note:** The WHERE clause that is used here is a standard SAS WHERE clause.

```
  POST /compute/sessions/{sessionId}/data/{libref}/{tableName}/rowSet

  {
     "where" : "x=1",
     "sortBy" : [
        {
        "key" : " my special column"
        }
  }
```

##### <a name='CreateDataView'>Create a View of Data</a>
You can create a view of an existing data set. You might do this to perform multiple tasks on a subset
of an existing data set or table. You might also do this to add sort indexes to a table that does not currently
have the ability to be sorted. To create a view, make a request similar to the following. A request body that indicates
the parameters for the creation of the view is provided.

**Note:** The WHERE clause that is used here is a standard SAS WHERE clause.

```
  POST /compute/sessions/{sessionId}/data/{libref}/{tableName}/views

  {
     "where" : "a=1',
     "sortBy" : [
        {
        "key" : " my special column"
        },
     "distinct" : true
  }
```

If the request is successful, an application/vnd.sas.compute.data.table response is returned.  This response can be used
like any other table that is returned from a session. You can request a row set for a table, or you can request individual
rows and columns. A view is available for use until either the session is destroyed or until the view is deleted.

##### <a name='UpdateTable'>Update a Table</a>
For a table that you can update, you can submit a request to rename the table or to update the label for the
table. Submit a PUT request that contains the information that you want to update. Members that you cannot update
or have not changed are ignored. Here is an example that renames the table WORK.TEST that has label MYTEST to be called
WORK.SUCCESS with label GOOD.

```
   PUT /compute/sessions/{sessionId}/data/WORK/MYTEST

   {
      "name" : "SUCCESS",
      "label" : "GOOD"
   }
```

If the update succeeds, new links are generated that reference the new table name. For a table in the WORK folder,
reference the table using this new name for the remainder of the session. If the table or data set is in a
persisted location, then the changes are persisted.

##### <a name='UpdateTableColumn'>Update a Table Column</a>
For tables that you can update, you can submit a request to update a column in the table.  Supported
updates for a column include the column name, label, format, and informat. Submit a PUT request that contains
the information that you want to update. Members that you cannot update or have not changed are ignored. Here is an
example that renames the ID column in table WORK.TEST to be USER.

```
   PUT /compute/sessions/{sessionId}/data/WORK/MYTEST/ID

   {
      "name" : "USER"
   }
```

If the update is successful, new links are generated that reference the new column name. For a table in the WORK folder,
you can refer to the column using the new name for the remainder of the session. For a table or data set in a
persisted location, the changes are persisted.

##### <a name='DeleteTable'>Delete a Table</a>
If you have the correct permissions, you can delete a table or data set by submitting a request to DELETE the resource.

```
  DELETE /compute/sessions/{sessionId}/data/{libref}/{tableName}
```


#### Accessing Files
The following are descriptions of how to work with files in the Compute service. The term fileref is based on the
concept of a SAS fileref.

##### <a name='ListAssignedFileref'>List Assigned Filerefs</a>
To obtain the listing of filerefs that are currently assigned in your session, submit a GET request to the filerefs
endpoint. A collection of application/vnd.sas.compute.fileref.summary objects is returned.

```
  GET /compute/sessions/{sessionId}/filerefs
```
Links are provided to access the individual filerefs themselves.

##### <a name='AssignNewFileref'>Assign a New Fileref</a>
To assign a new fileref, submit an application/vnd.sas.compute.fileref.request to the filerefs endpoint. This request
contains the path and access method to use for the fileref and the requested name of the fileref.

```
  POST /compute/sessions/{sessionId}/filerefs
```

##### <a name='DownloadFileFileref'>Download a File from a Fileref</a>
To download the underlying file from a fileref, submit a GET request to the content endpoint. The server attempts
to determine the content of the file and to set that on the Content-type header of the response. If the content cannot be
determined, the header is set to application/octet-stream.

```
  GET /compute/sessions/{sessionId}/filerefs/{filreref}/content
```

##### <a name='UploadFileFileref'>Upload a File to a Fileref</a>
To upload a file to the server using a fileref, submit a PUT request to the content endpoint for that fileref. The
body of the request is written to the file.

```
  PUT /compute/sessions/{sessionId}/filerefs/{filreref}/content
  If-Match: "<etag>"
```
Conditional PUT support is enabled for this endpoint. To submit data to update the fileref, the current ETag must be
provided.

##### <a name='AppendFileFileref'>Append a File to a Fileref</a>
To append a file to the server that is using the fileref, submit a POST request to the content endpoint for that fileref.
The body of the request is appended to the file.

```
  POST /compute/sessions/{sessionId}/filerefs/{filreref}/content
```

##### <a name='HandleDirectoryFileref'>Handle a Directory Fileref</a>
If a fileref refers to a directory rather than a single file, you can get a directoy listing by setting the Accept
header on the GET request for the content endpoint to application/vnd.sas.collection. A collection of
application/vnd.sas.compute.fileref.directory.member objects is returned.

```
  GET /compute/sessions/{sessionId}/filerefs/{fileref}/content
  Accept: application/vnd.sas.collection+json
```
Links are provided so that you can access the underlying files in the directory. Shortcuts are also provided to create
filerefs for the member entries.

**Note:** Directories are currently Read-only. You can update individual members in the
directory, but updating the directory as a whole is not currently supported.

To download a member file from the directory, submit a GET request to the content endpoint for the directory fileref
with a member query parameter. The server attempts to determine the content of the file and to set that content on the
Content-type header of the response. If the content cannot be determined, the header is set to application/octet-stream.

```
  GET /compute/sessions/{sessionId}/filerefs/{filreref}/content?member={memberName}
```
To upload a member file in the directory, submit a PUT request to the content endpoint for the directory fileref with
a member query parameter. The body of the request is written to the file.

```
  PUT /compute/sessions/{sessionId}/filerefs/{filreref}/content?member={memberName}
```
To append a member file in the directory, submit a POST request to the content endpoint for the directory fileref with
 a member query parameter. The body of the request is appended to the file.

```
  POST /compute/sessions/{sessionId}/filerefs/{filreref}/content?member={memberName}
```

##### <a name='HandleConcatenationFileref'>Handle a Concatenation Fileref</a>
In some cases, a fileref refers to a concatenated list of flat files, such as "('file1.txt' 'file2.txt' ..)".
A GET request to the content endpoint for this kind of fileref downloads the content of all the flat files in the
concatenation list.
```
  GET /compute/sessions/{sessionId}/filerefs/{fileref}/content
```
A PUT request on the content endpoint for this kind of fileref uploads content to the first file in the
concatenation list.
```
  PUT /compute/sessions/{sessionId}/filerefs/{fileref}/content
```
In some cases, a fileref refers to a concatenated list of directories, such as "('dir1' 'dir2' ...)".
A GET request on the content endpoint for this kind of fileref returns a list of all members in all
directories in the concatenation list.
```
 GET /compute/sessions/{sessionId}/filerefs/{fileref}/content
```
A fileref that refers to a concatenation of files and directories is not supported and receives an error at fileref
assignment.

#### Cleanup
##### <a name='EndSession'>End a session</a>
Once all work is done in a session, the session should be closed by the user. To do this, submit the following request.

```
   DELETE /compute/sessions/{sessionId}
```
This forces the Session to be destroyed.

**Note:** All resources, logs, results, jobs, and so on that are tied directly to this session are also destroyed and
are no longer reachable.

version 2, last updated 08 Jul, 2019